const bindCardSlider=e=>!(!e||!e.classList.contains("swiper"))&&(Swiper?new Swiper(e,{pagination:{el:".swiper-pagination",clickable:!0}}):void 0),bindLikeBtn=(e,t)=>{if(!e||!t)return!1;e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__like_liked")?fetch("/somepath/"+t).then((e=>e.json())).then((t=>{if("success"!==t.status)throw new Error("Серверная ошибка удаления товара из понравившихся");e.target.classList.remove("item-card__like_liked")})).catch((e=>{console.log(e)})):fetch("/somepath/"+t).then((e=>e.json())).then((t=>{if("success"!==t.status)throw new Error("Серверная ошибка добавления товара в понравившиеся");e.target.classList.add("item-card__like_liked")})).catch((e=>{console.log(e)}))}))},bindCompareBtn=(e,t)=>{if(!e||!t)return!1;e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__compare_compared")?fetch("/somepath/"+t).then((e=>e.json())).then((t=>{if("success"!==t.status)throw new Error("Серверная ошибка удаления товара из сравнения");e.target.classList.remove("item-card__compare_compared")})).catch((e=>{console.log(e)})):fetch("/somepath/"+t).then((e=>e.json())).then((t=>{if("success"!==t.status)throw new Error("Серверная ошибка добавления товара в сравнение");e.target.classList.add("item-card__compare_compared")})).catch((e=>{console.log(e)}))}))},bindCartBtn=(e,t,i)=>{if(!e||!t)return!1;e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__cart_in-cart")?fetch(`/ajax/basket.php?id=${t}&delete=Y`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка удаления товара из корзины");e.target.classList.remove("item-card__cart_in-cart")})).catch((e=>{console.log(e)})):fetch(`/ajax/basket.php?id=${t}&count=1&json=1`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка добавления товара в корзину");e.target.classList.add("item-card__cart_in-cart"),Fancybox.show([{src:`<div class="modal-cart-confirmation">\n<div>Товар <b>"${i}"</b> добавлен в корзину.</div>\n<div class="modal-cart-confirmation__buttons">\n<a href="/cart/">Перейти в корзину</a>\n<div class="is-close-btn" onclick="Fancybox.close()">Продолжить покупки</div>\n</div>\n</div>`,type:"html"}])})).catch((e=>{console.log(e)}))}))},bindItemCard=e=>{if(!e)return!1;const t=e.getAttribute("data-item-id");bindCardSlider(e.querySelector(".swiper")),bindLikeBtn(e.querySelector(".js-item-card-like"),t),bindCompareBtn(e.querySelector(".js-item-card-compare"),t);const i=e.querySelector(".item-card__name").innerText;for(const r of e.querySelectorAll(".js-item-card-cart"))bindCartBtn(r,t,i)},itemsSlider=e=>!!e&&(Swiper?new Swiper(e.querySelector(".swiper"),{slidesPerView:8,spaceBetween:20,breakpoints:{1730:{slidesPerView:8},1560:{slidesPerView:7},1360:{slidesPerView:6},1100:{slidesPerView:5},851:{slidesPerView:4},641:{slidesPerView:3},351:{slidesPerView:2},0:{slidesPerView:1}}}):void 0),bindPerPageSelect=e=>{if(!e||!NiceSelect)return!1;NiceSelect.bind(e)},bindSortSelect=e=>{if(!e||!NiceSelect)return!1;NiceSelect.bind(e),e.addEventListener("change",(e=>{const t=new URLSearchParams(window.location.search);t.set(e.target.getAttribute("name"),e.target.value),t.toString(),localStorage.setItem("scrollToCatalog","1"),window.location=window.location.pathname+"?"+t.toString()}))},bindFilterShowButton=e=>{if(!e)return!1;if(!e.querySelectorAll(".filter__checkbox"))return!1;const t=e.querySelector(".filter__show-more");if(!t)return!1;const i=t.innerHTML;t.addEventListener("click",(r=>{r.preventDefault(),e.classList.toggle("filter_show-all"),"свернуть"===t.innerHTML.toLowerCase()?t.innerHTML=i:t.innerHTML="Свернуть"}))},scrollToCatalog=()=>{const e=localStorage.getItem("scrollToCatalog"),t=document.querySelector(".catalog-layout");e&&t&&(t.scrollIntoView({behavior:"smooth"}),localStorage.removeItem("scrollToCatalog"))},bindFilterPrice=e=>{if(!e)return!1;const t=e.querySelector(".filter__price-slider");if(!t||!noUiSlider)return!1;noUiSlider.create(t,{start:[Number(t.getAttribute("data-min"))||0,Number(t.getAttribute("data-max"))||5e5],connect:!0,step:100,range:{min:Number(t.getAttribute("data-min"))||0,max:Number(t.getAttribute("data-max"))||5e5}});const i=e.querySelector('[name="price_from"]'),r=e.querySelector('[name="price_to"]');t.noUiSlider.on("update",(function(e,t){const n=e[t];t?r.value=Math.round(n):i.value=Math.round(n)})),i.addEventListener("change",(function(){t.noUiSlider.set([this.value,null])})),r.addEventListener("change",(function(){t.noUiSlider.set([null,this.value])}))},bindSectionsListAdaptive=e=>{if(!e)return!1;if(window.matchMedia("(max-width: 750px)").matches&&window.ADAPTIVE_SUBSECTIONS_FLAG)return!1;if(window.matchMedia("(min-width: 751px)").matches&&!window.ADAPTIVE_SUBSECTIONS_FLAG)return!1;if(window.matchMedia("(max-width: 750px)").matches&&!window.ADAPTIVE_SUBSECTIONS_FLAG){window.ADAPTIVE_SUBSECTIONS_FLAG=!0;const t=document.createElement("div");t.classList.add("sections-list-select");const i=e.querySelector("ul"),r=i.querySelector(".sections-list__item_active");r||(t.innerText="Выбрать раздел каталога"),r&&(t.append(r.cloneNode(!0)),t.querySelector("a").addEventListener("click",(e=>{e.preventDefault()})));const n=document.createElement("li");n.setAttribute("type","button"),n.classList.add("sections-list__close-btn"),i.append(n),e.after(t),t.addEventListener("click",(t=>{e.classList.toggle("sections-list_opened")})),e.addEventListener("click",(t=>{e!==t.target&&n!==t.target||e.classList.remove("sections-list_opened")}))}window.matchMedia("(min-width: 751px)").matches&&window.ADAPTIVE_SUBSECTIONS_FLAG&&(window.ADAPTIVE_SUBSECTIONS_FLAG=!1,document.querySelector(".sections-list-select")&&document.querySelector(".sections-list-select").remove())},bindFiltersAdaptive=()=>{const e=document.querySelector(".sort__filters-adaptive"),t=document.querySelector(".catalog-layout__sidebar");if(!t&&e)return e.style.display="none",!1;if(!t||!e)return!1;const i=r=>r?r.target!==e&&(r.target!==t&&!t.contains(r.target)&&(t.classList.remove("catalog-layout__sidebar_opened"),void document.removeEventListener("click",i))):(t.classList.remove("catalog-layout__sidebar_opened"),document.removeEventListener("click",i),!0);e.addEventListener("click",(e=>{e.preventDefault(),t.classList.contains("catalog-layout__sidebar_opened")?i():(t.classList.add("catalog-layout__sidebar_opened"),document.addEventListener("click",i))})),t.querySelector(".catalog-layout__sidebar-close").addEventListener("click",(e=>{e.preventDefault(),i()})),t.querySelector(".filters__actions button").addEventListener("click",(()=>{i()}))},bindFilterChange=e=>{if(!e)return!1;const t=[...e.querySelectorAll("input")],i=e.querySelector(".filters__actions button");t.map((e=>{e.addEventListener("change",(()=>{i.style.visibility="visible",i.style.opacity="1"}))})),i.addEventListener("click",(e=>{e.preventDefault(),i.style.visibility="hidden",i.style.opacity="0"}))};window.addEventListener("DOMContentLoaded",(()=>{for(const e of document.querySelectorAll(".item-card"))bindItemCard(e);for(const e of document.querySelectorAll(".items-slider"))itemsSlider(e);for(const e of document.querySelectorAll(".sort__item select"))bindSortSelect(e);scrollToCatalog();for(const e of document.querySelectorAll(".filter"))bindFilterShowButton(e);for(const e of document.querySelectorAll(".filter__price"))bindFilterPrice(e);bindSectionsListAdaptive(document.querySelector(".sections-list")),bindFiltersAdaptive(),bindFilterChange(document.querySelector(".filters"))})),window.addEventListener("resize",(()=>{bindSectionsListAdaptive(document.querySelector(".sections-list"))}));
//# sourceMappingURL=catalog.min.js.map
