const bindCardSlider=e=>!(!e||!e.classList.contains("swiper"))&&(Swiper?new Swiper(e,{pagination:{el:".swiper-pagination",clickable:!0}}):void 0),bindLikeBtn=(e,t)=>{if(!e||!t)return!1;const a=document.querySelector(".headerActions__btn_favorites");e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__like_liked")?fetch(`/ajax/favorites.php?id=${t}&delete=Y`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка удаления товара из понравившихся");e.target.classList.remove("item-card__like_liked"),void 0!==t.count&&a&&(isNaN(t.count)||a.setAttribute("data-count",String(t.count)));if(document.querySelector(".catalog_favorites")){const t=e.target.closest(".catalog__item");t&&t.remove()}})).catch((e=>{console.log(e)})):fetch(`/ajax/favorites.php?id=${t}`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка добавления товара в понравившиеся");e.target.classList.add("item-card__like_liked"),void 0!==t.count&&a&&(isNaN(t.count)||a.setAttribute("data-count",String(t.count)))})).catch((e=>{console.log(e)}))}))},bindCompareBtn=(e,t)=>{if(!e||!t)return!1;const a=document.querySelector(".headerActions__btn_compare");e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__compare_compared")?fetch(`/ajax/compare.php?id=${t}&delete=Y`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка удаления товара из сравнения");e.target.classList.remove("item-card__compare_compared"),void 0!==t.count&&a&&!isNaN(t.count)&&a.setAttribute("data-count",String(t.count))})).catch((e=>{console.log(e)})):fetch(`/ajax/compare.php?id=${t}`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка добавления товара в сравнение");e.target.classList.add("item-card__compare_compared"),void 0!==t.count&&a&&!isNaN(t.count)&&a.setAttribute("data-count",String(t.count))})).catch((e=>{console.log(e)}))}))},bindCartBtn=(e,t,a)=>{if(!e||!t)return!1;const c=document.querySelector(".headerActions__btn_basket");e.addEventListener("click",(a=>{a.preventDefault();let r=e.getAttribute("data-name"),n=e.getAttribute("data-img");console.log(r,n),a.target.classList.contains("item-card__cart_in-cart")?fetch(`/ajax/basket.php?id=${t}&delete=Y`).then((e=>e.json())).then((e=>{if(!e.success)throw new Error("Серверная ошибка удаления товара из корзины");a.target.classList.remove("item-card__cart_in-cart"),void 0!==e.count&&c&&(isNaN(e.count)||c.setAttribute("data-count",String(e.count)))})).catch((e=>{console.log(e)})):fetch(`/ajax/basket.php?id=${t}&count=1&json=1`).then((e=>e.json())).then((e=>{if(!e.success)throw new Error("Серверная ошибка добавления товара в корзину");a.target.classList.add("item-card__cart_in-cart"),Fancybox.show([{src:`<div class="modal modal_white modal_card">\n                                    <div class="modal__body modal-card">\n                                        <div class="modal-card__title">Товар добавлен в корзину</div>\n                                        <div class="modal-card__inner">\n                                            <span class="modal-card__img">\n                                                <img src="${n}" alt="">\n                                            </span>\n                                            <span class="modal-card__name">"${r}"</span>\n                                            <div class="modal-card__wrapper">\n                                                <div class="modal-card__prices">\n                                                    <div class="modal-card__price">4&nbsp;596&nbsp;₽</div>\n                                                    <div class="modal-card__price modal-card__price_old">4&nbsp;596&nbsp;₽</div>\n                                                </div>\n                                                <div class="modal-card__actions">\n                                                    <a href="/cart" class="modal-card__btn modal-card__btn_cart">В корзину</a>\n                                                    <button type="button" class="modal-card__btn modal-card__btn_close" onclick="Fancybox.close()">В каталог</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>`,type:"html"}]),void 0!==e.count&&c&&(isNaN(e.count)||c.setAttribute("data-count",String(e.count)))})).catch((e=>{console.log(e)}))}))},bindItemCard=e=>{if(!e)return!1;const t=e.getAttribute("data-item-id");let a;bindCardSlider(e.querySelector(".swiper")),bindLikeBtn(e.querySelector(".js-item-card-like"),t),bindCompareBtn(e.querySelector(".js-item-card-compare"),t),a=e.classList.contains("card")?document.querySelector(".page-title_card h1").innerText:e.querySelector(".item-card__name").innerText;for(const a of e.querySelectorAll(".js-item-card-cart"))bindCartBtn(a,t)},bindSearchTabs=e=>{if(!e)return!1;[...e.querySelectorAll(".search-page__toggle")].map((t=>{t.addEventListener("click",(a=>{a.preventDefault(),e.querySelector(".search-page__toggle_active")&&e.querySelector(".search-page__toggle_active").classList.remove("search-page__toggle_active"),t.classList.add("search-page__toggle_active"),e.querySelector(".search-page__results_active")&&e.querySelector(".search-page__results_active").classList.remove("search-page__results_active"),e.querySelector(t.getAttribute("href")).classList.add("search-page__results_active")}))}))};window.addEventListener("DOMContentLoaded",(()=>{bindSearchTabs(document.querySelector(".search-page"));for(const e of document.querySelectorAll(".item-card"))bindItemCard(e)}));
//# sourceMappingURL=search.min.js.map
