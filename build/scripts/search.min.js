const bindCardSlider=e=>!(!e||!e.classList.contains("swiper"))&&(Swiper?new Swiper(e,{pagination:{el:".swiper-pagination",clickable:!0}}):void 0),bindLikeBtn=(e,t)=>{if(!e||!t)return!1;const c=document.querySelector(".headerActions__btn_favorites");e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__like_liked")?fetch(`/ajax/favorites.php?id=${t}&delete=Y`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка удаления товара из понравившихся");e.target.classList.remove("item-card__like_liked"),void 0!==t.count&&c&&(isNaN(t.count)||c.setAttribute("data-count",String(t.count)));if(document.querySelector(".catalog_favorites")){const t=e.target.closest(".catalog__item");t&&t.remove()}})).catch((e=>{console.log(e)})):fetch(`/ajax/favorites.php?id=${t}`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка добавления товара в понравившиеся");e.target.classList.add("item-card__like_liked"),void 0!==t.count&&c&&(isNaN(t.count)||c.setAttribute("data-count",String(t.count)))})).catch((e=>{console.log(e)}))}))},bindCompareBtn=(e,t)=>{if(!e||!t)return!1;const c=document.querySelector(".headerActions__btn_compare");e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__compare_compared")?fetch(`/ajax/compare.php?id=${t}&delete=Y`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка удаления товара из сравнения");e.target.classList.remove("item-card__compare_compared"),void 0!==t.count&&c&&!isNaN(t.count)&&c.setAttribute("data-count",String(t.count))})).catch((e=>{console.log(e)})):fetch(`/ajax/compare.php?id=${t}`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка добавления товара в сравнение");e.target.classList.add("item-card__compare_compared"),void 0!==t.count&&c&&!isNaN(t.count)&&c.setAttribute("data-count",String(t.count))})).catch((e=>{console.log(e)}))}))},bindCartBtn=(e,t,c)=>{if(!e||!t)return!1;const a=document.querySelector(".headerActions__btn_basket");e.addEventListener("click",(e=>{e.preventDefault(),e.target.classList.contains("item-card__cart_in-cart")?fetch(`/ajax/basket.php?id=${t}&delete=Y`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка удаления товара из корзины");e.target.classList.remove("item-card__cart_in-cart"),void 0!==t.count&&a&&(isNaN(t.count)||a.setAttribute("data-count",String(t.count)))})).catch((e=>{console.log(e)})):fetch(`/ajax/basket.php?id=${t}&count=1&json=1`).then((e=>e.json())).then((t=>{if(!t.success)throw new Error("Серверная ошибка добавления товара в корзину");e.target.classList.add("item-card__cart_in-cart"),Fancybox.show([{src:`<div class="modal-cart-confirmation">\n<div>Товар <b>"${c}"</b> добавлен в корзину.</div>\n<div class="modal-cart-confirmation__buttons">\n<a href="/basket/">Перейти в корзину</a>\n<div class="is-close-btn" onclick="Fancybox.close()">Продолжить покупки</div>\n</div>\n</div>`,type:"html"}]),void 0!==t.count&&a&&(isNaN(t.count)||a.setAttribute("data-count",String(t.count)))})).catch((e=>{console.log(e)}))}))},bindItemCard=e=>{if(!e)return!1;const t=e.getAttribute("data-item-id");bindCardSlider(e.querySelector(".swiper")),bindLikeBtn(e.querySelector(".js-item-card-like"),t),bindCompareBtn(e.querySelector(".js-item-card-compare"),t);const c=e.querySelector(".item-card__name").innerText;for(const a of e.querySelectorAll(".js-item-card-cart"))bindCartBtn(a,t,c)},bindSearchTabs=e=>{if(!e)return!1;[...e.querySelectorAll(".search-page__toggle")].map((t=>{t.addEventListener("click",(c=>{c.preventDefault(),e.querySelector(".search-page__toggle_active")&&e.querySelector(".search-page__toggle_active").classList.remove("search-page__toggle_active"),t.classList.add("search-page__toggle_active"),e.querySelector(".search-page__results_active")&&e.querySelector(".search-page__results_active").classList.remove("search-page__results_active"),e.querySelector(t.getAttribute("href")).classList.add("search-page__results_active")}))}))};window.addEventListener("DOMContentLoaded",(()=>{bindSearchTabs(document.querySelector(".search-page"));for(const e of document.querySelectorAll(".item-card"))bindItemCard(e)}));
//# sourceMappingURL=search.min.js.map
