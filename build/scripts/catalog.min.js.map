{"version":3,"file":"catalog.min.js","names":["bindCardSlider","sliderNode","classList","contains","Swiper","pagination","el","clickable","bindLikeBtn","btnNode","id","addEventListener","e","preventDefault","target","fetch","then","resp","json","status","Error","remove","catch","err","console","log","add","bindCompareBtn","bindCartBtn","name","Fancybox","show","src","type","bindItemCard","itemCardNode","itemId","getAttribute","querySelector","innerText","cartBtn","querySelectorAll","itemsSlider","slidesPerView","spaceBetween","bindPerPageSelect","selectNode","NiceSelect","bind","bindSortSelect","params","URLSearchParams","window","location","search","set","value","toString","localStorage","setItem","pathname","bindFilterShowButton","filterNode","showBtn","initialBtnText","innerHTML","toggle","toLowerCase","scrollToCatalog","flag","getItem","catalogNode","document","scrollIntoView","behavior","removeItem","bindFilterPrice","noUiSlider","create","start","Number","connect","step","range","min","max","inputMin","inputMax","on","values","handle","Math","round","this","cardItemNode","itemsSliderNode"],"sources":["catalog.js"],"sourcesContent":["const bindCardSlider = (sliderNode) => {\n    if (!sliderNode || !sliderNode.classList.contains('swiper')) {\n        return false;\n    }\n\n    if (!!Swiper) {\n        return new Swiper(sliderNode, {\n            pagination: {\n                el: \".swiper-pagination\",\n                clickable: true,\n            },\n        })\n    }\n}\n\nconst bindLikeBtn = (btnNode, id) => {\n    if (!btnNode || !id) {\n        return false;\n    }\n\n    btnNode.addEventListener('click', (e) => {\n        e.preventDefault();\n\n        if (e.target.classList.contains('item-card__like_liked')) {\n            //todo: здесь вставить запрос на удаление из лайков\n            fetch('/somepath/' + id)\n                .then((resp) => resp.json())\n                .then((resp) => {\n                    if (resp.status === 'success') {\n                        e.target.classList.remove('item-card__like_liked')\n                    } else {\n                        throw new Error('Серверная ошибка удаления товара из понравившихся')\n                    }\n                })\n                .catch((err) => {\n                    console.log(err)\n                })\n        } else {\n            //todo: здесь вставить запрос на добавление в лайки\n            fetch('/somepath/' + id)\n                .then((resp) => resp.json())\n                .then((resp) => {\n                    if (resp.status === 'success') {\n                        e.target.classList.add('item-card__like_liked')\n                    } else {\n                        throw new Error('Серверная ошибка добавления товара в понравившиеся')\n                    }\n                })\n                .catch((err) => {\n                    console.log(err)\n                })\n        }\n    })\n}\n\nconst bindCompareBtn = (btnNode, id) => {\n    if (!btnNode || !id) {\n        return false;\n    }\n\n    btnNode.addEventListener('click', (e) => {\n        e.preventDefault();\n\n        if (e.target.classList.contains('item-card__compare_compared')) {\n            //todo: здесь вставить запрос на удаление из сравнения\n            fetch('/somepath/' + id)\n                .then((resp) => resp.json())\n                .then((resp) => {\n                    if (resp.status === 'success') {\n                        e.target.classList.remove('item-card__compare_compared')\n                    } else {\n                        throw new Error('Серверная ошибка удаления товара из сравнения')\n                    }\n                })\n                .catch((err) => {\n                    console.log(err)\n                })\n        } else {\n            //todo: здесь вставить запрос на добавление в сравнение\n            fetch('/somepath/' + id)\n                .then((resp) => resp.json())\n                .then((resp) => {\n                    if (resp.status === 'success') {\n                        e.target.classList.add('item-card__compare_compared')\n                    } else {\n                        throw new Error('Серверная ошибка добавления товара в сравнение')\n                    }\n                })\n                .catch((err) => {\n                    console.log(err)\n                })\n        }\n    })\n}\n\nconst bindCartBtn = (btnNode, id, name) => {\n    if (!btnNode || !id) {\n        return false;\n    }\n\n    btnNode.addEventListener('click', (e) => {\n        e.preventDefault();\n\n        if (e.target.classList.contains('item-card__cart_in-cart')) {\n            //todo: здесь вставить запрос на удаление из корзины\n            fetch('/somepath/' + id)\n                .then((resp) => resp.json())\n                .then((resp) => {\n                    if (resp.status === 'success') {\n                        e.target.classList.remove('item-card__cart_in-cart')\n                    } else {\n                        throw new Error('Серверная ошибка удаления товара из корзины')\n                    }\n                })\n                .catch((err) => {\n                    console.log(err)\n                })\n        } else {\n            //todo: здесь вставить запрос на добавление в корзину\n\n            // todo перенести код фэнсибокс\n            Fancybox.show([\n                {\n                    src: `<div class=\"modal-cart-confirmation\">\n<div>Товар <b>\"${name}\"</b> добавлен в корзину.</div>\n<div class=\"modal-cart-confirmation__buttons\">\n<a href=\"/cart/\">Перейти в корзину</a>\n<div class=\"is-close-btn\" onclick=\"Fancybox.close()\">Продолжить покупки</div>\n</div>\n</div>`,\n                    type: \"html\",\n                },\n            ]);\n            fetch('/somepath/' + id)\n                .then((resp) => resp.json())\n                .then((resp) => {\n                    if (resp.status === 'success') {\n                        e.target.classList.add('item-card__cart_in-cart')\n                        //todo перенести код фэнсибокс сюда\n                    } else {\n                        throw new Error('Серверная ошибка добавления товара в корзину')\n                    }\n                })\n                .catch((err) => {\n                    console.log(err)\n                })\n        }\n    })\n}\n\nconst bindItemCard = (itemCardNode) => {\n    if (!itemCardNode) {\n        return false;\n    }\n\n    const itemId = itemCardNode.getAttribute('data-item-id');\n\n    bindCardSlider(itemCardNode.querySelector('.swiper'));\n\n    bindLikeBtn(itemCardNode.querySelector('.js-item-card-like'), itemId);\n\n    bindCompareBtn(itemCardNode.querySelector('.js-item-card-compare'), itemId);\n\n    const name = itemCardNode.querySelector('.item-card__name').innerText;\n\n    for (const cartBtn of itemCardNode.querySelectorAll('.js-item-card-cart')) {\n        bindCartBtn(cartBtn, itemId, name)\n    }\n\n}\n\nconst itemsSlider = (sliderNode) => {\n    if (!sliderNode) {\n        return false;\n    }\n\n    if (!!Swiper) {\n        return new Swiper(sliderNode.querySelector('.swiper'), {\n            slidesPerView: 5,\n            spaceBetween: 50,\n        })\n    }\n}\n\nconst bindPerPageSelect = (selectNode) => {\n    if (!selectNode || !NiceSelect) {\n        return false;\n    }\n\n    NiceSelect.bind(selectNode);\n}\n\nconst bindSortSelect = (selectNode) => {\n    if (!selectNode || !NiceSelect) {\n        return false;\n    }\n\n    NiceSelect.bind(selectNode);\n\n    selectNode.addEventListener('change', (e) => {\n        const params = new URLSearchParams(window.location.search);\n\n        params.set(e.target.getAttribute('name'), e.target.value);\n        params.toString();\n\n        localStorage.setItem('scrollToCatalog', '1');\n\n        window.location = window.location.pathname + '?' + params.toString();\n    })\n}\n\nconst bindFilterShowButton = (filterNode) => {\n    if (!filterNode) {\n        return false;\n    }\n\n    const checkboxes = filterNode.querySelectorAll('.filter__checkbox');\n\n    if (!checkboxes) {\n        return false;\n    }\n\n    /*for (const checkbox of checkboxes) {\n        if (checkbox.classList.contains('filter__checkbox_show')) {\n            checkbox.setAttribute('data-default', '1');\n        }\n    }*/\n\n    const showBtn = filterNode.querySelector('.filter__show-more');\n\n    if (!showBtn) {\n        return false;\n    }\n\n    const initialBtnText = showBtn.innerHTML;\n\n    showBtn.addEventListener('click', (e) => {\n        e.preventDefault();\n\n        filterNode.classList.toggle('filter_show-all');\n\n        showBtn.innerHTML.toLowerCase() === 'свернуть' ? showBtn.innerHTML = initialBtnText : showBtn.innerHTML = 'Свернуть';\n\n    })\n}\n\nconst scrollToCatalog = () => {\n    const flag = localStorage.getItem('scrollToCatalog');\n    const catalogNode = document.querySelector('.catalog-layout');\n\n    if (flag && catalogNode) {\n        catalogNode.scrollIntoView({behavior: 'smooth'});\n\n        localStorage.removeItem('scrollToCatalog');\n    }\n}\n\nconst bindFilterPrice = (filterNode) => {\n    if (!filterNode) {\n        return false;\n    }\n\n    const sliderNode = filterNode.querySelector('.filter__price-slider');\n\n    if (!sliderNode || !noUiSlider) {\n        return false;\n    }\n\n    noUiSlider.create(sliderNode, {\n        start: [Number(sliderNode.getAttribute('data-min')) || 0, Number(sliderNode.getAttribute('data-max')) || 500000],\n        connect: true,\n        step: 100,\n        range: {\n            'min': Number(sliderNode.getAttribute('data-min')) || 0,\n            'max': Number(sliderNode.getAttribute('data-max')) || 500000,\n        },\n    });\n\n    const inputMin = filterNode.querySelector('[name=\"price_from\"]');\n    const inputMax = filterNode.querySelector('[name=\"price_to\"]');\n\n    sliderNode.noUiSlider.on('update', function (values, handle) {\n\n        const value = values[handle];\n\n        if (handle) {\n            inputMax.value = Math.round(value);\n        } else {\n            inputMin.value = Math.round(value);\n        }\n    });\n\n    inputMin.addEventListener('change', function () {\n        sliderNode.noUiSlider.set([this.value, null]);\n    });\n\n    inputMax.addEventListener('change', function () {\n        sliderNode.noUiSlider.set([null, this.value]);\n    });\n\n\n}\n\nwindow.addEventListener('DOMContentLoaded', () => {\n\n    for (const cardItemNode of document.querySelectorAll('.item-card')) {\n        bindItemCard(cardItemNode)\n    }\n\n    for (const itemsSliderNode of document.querySelectorAll('.items-slider')) {\n        itemsSlider(itemsSliderNode)\n    }\n\n    for (const sliderNode of document.querySelectorAll('.sort__item select')) {\n        bindSortSelect(sliderNode)\n    }\n\n    scrollToCatalog();\n\n    for (const filterNode of document.querySelectorAll('.filter')) {\n        bindFilterShowButton(filterNode)\n    }\n\n    for (const filterNode of document.querySelectorAll('.filter__price')) {\n        bindFilterPrice(filterNode)\n    }\n\n})\n\n"],"mappings":"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"}